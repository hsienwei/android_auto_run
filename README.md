# 一個簡單的自動化測試範例

依照在公司內部分享會聽到的自動化測試演講為基礎的練習  
水能載舟, 亦能覆舟  
網頁測試自動化工具也被大家拿來寫爬蟲  
所以用手機應用自動化測試的流程拿來寫自動練功流程也是相當合理  

# 案例解說

以現在在玩的遊戲King's raid為例  
現在掛著練等級的時候會遇到一個狀況  
那就是當道具滿了的時候會強制停止  
這個測試希望能做到當道具滿了的時候進行自動分解裝備的流程  
然後回到練等的流程  

# 原理
使用adb的截圖功能將現在運行的畫面截圖後, 使用OpenCV的功能來對目前畫面做特殊物件的判定, 並使用adb來模擬點擊操作

# 前置作業
0. 先確定是否有裝python3與android sdk, 確認adb可以使用
1. 個人使用Momo模擬器, 調成平板版1600 * 900
2. 先執行過一次批次分解, 由於批次分解的設定設定過就會暫存, 可以以此設定當裝備滿了之後想要怎麼處理
3. 重要道具請先上鎖
4. 選擇一個要掛的關卡, 先確認可以非常穩的打過去, 然後確認體力夠不夠, 是否要開雙倍經驗之類的道具
5. 進入自動重複戰鬥的流程, 開啟腳本

# 結果
[運行畫面流程](https://imgur.com/a/zRu4eDd)    
圖上的藍點則是呼叫adb去點擊的位置

# 後記
- 目前使用OpenCV的MatchTemplate功能來做判定, 但是這個會有一個問題就是當解析度變更會影響到找圖的結果, 所以前置作業才需要指定解析度, 這個或許可以改成找特徵的方式
- 目前沒有針對太多的例外狀況去處理, 所以有時候會因為一些跨日跳出的事件導致中斷
- 這個自動化功能應該有一些大廠有做了, 本篇純粹測試用
